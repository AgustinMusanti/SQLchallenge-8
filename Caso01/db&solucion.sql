IF object_id('ventas') IS NOT NULL
DROP TABLE ventas;

CREATE TABLE ventas (
    id         INT PRIMARY KEY,
    cliente_id VARCHAR(10),
    fecha      DATE,
    monto      DECIMAL(10,2)
);


INSERT INTO ventas
VALUES
(1, 'C001', '2025-01-01', 120.50),
(2, 'C002', '2025-01-01', 75.00),
(3, 'C003', '2025-01-02', 300.00),
(4, 'C001', '2025-01-03', 450.00),
(5, 'C004', '2025-01-03', 50.00),
(6, 'C005', '2025-01-04', 900.00),
(7, 'C002', '2025-01-05', 110.00),
(8, 'C003', '2025-01-05', 80.00),
(9, 'C006', '2025-01-06', 1000.00),
(10, 'C007', '2025-01-06', 200.00),
(11, 'C008', '2025-01-07', 60.00),
(12, 'C009', '2025-01-07', 45.00),
(13, 'C010', '2025-01-08', 700.00),
(14, 'C005', '2025-01-08', 250.00),
(15, 'C006', '2025-01-09', 320.00),
(16, 'C011', '2025-01-10', 150.00),
(17, 'C012', '2025-01-10', 85.00),
(18, 'C013', '2025-01-11', 40.00),
(19, 'C014', '2025-01-11', 500.00),
(20, 'C015', '2025-01-12', 60.00),
(21, 'C016', '2025-01-12', 220.00),
(22, 'C017', '2025-01-13', 95.00),
(23, 'C018', '2025-01-13', 1400.00),
(24, 'C019', '2025-01-14', 180.00),
(25, 'C020', '2025-01-14', 75.00),
(26, 'C021', '2025-01-15', 360.00),
(27, 'C022', '2025-01-15', 90.00),
(28, 'C023', '2025-01-16', 120.00),
(29, 'C024', '2025-01-16', 55.00),
(30, 'C025', '2025-01-17', 100.00),
(31, 'C026', '2025-01-17', 980.00),
(32, 'C027', '2025-01-18', 400.00),
(33, 'C028', '2025-01-18', 70.00),
(34, 'C029', '2025-01-19', 130.00),
(35, 'C030', '2025-01-19', 60.00),
(36, 'C031', '2025-01-20', 300.00),
(37, 'C032', '2025-01-20', 115.00),
(38, 'C033', '2025-01-21', 45.00),
(39, 'C034', '2025-01-21', 500.00),
(40, 'C035', '2025-01-22', 2000.00),
(41, 'C036', '2025-01-22', 250.00),
(42, 'C037', '2025-01-23', 180.00),
(43, 'C038', '2025-01-23', 60.00),
(44, 'C039', '2025-01-24', 100.00),
(45, 'C040', '2025-01-24', 350.00),
(46, 'C041', '2025-01-25', 75.00),
(47, 'C042', '2025-01-25', 95.00),
(48, 'C043', '2025-01-26', 80.00),
(49, 'C044', '2025-01-26', 600.00),
(50, 'C045', '2025-01-27', 90.00);


WITH clientes AS (
    SELECT 
        cliente_id,
        SUM(monto) AS total_cliente,
        NTILE(10) OVER (ORDER BY SUM(monto) DESC) AS decil
    FROM ventas
    GROUP BY cliente_id
)
SELECT 
    ROUND(100.0 * SUM(CASE WHEN decil = 1 THEN total_cliente END) / SUM(total_cliente), 2) AS pct_top10
FROM clientes;



